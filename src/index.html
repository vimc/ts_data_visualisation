<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>

    <link type="text/css" rel="stylesheet" href="bootstrap.css"/>
    <link type="text/css" rel="stylesheet" href="styles.css"/>
    <link type="text/css" rel="stylesheet" href="select2.min.css"/>
    <link type="text/css" rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.css"/>
    <link type="text/css" rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.theme.css"/>

    <!-- We seem to need this to get the collapsable card to work -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.0/css/bootstrap4-toggle.min.css"
          rel="stylesheet">

    <!-- Loading Screen -->
    <script type="text/javascript">
        $(window).ready(function () {
            // Animate loader off screen
            $(".loader-wrapper").fadeOut("fast");
        });
    </script>
</head>

<body>
<div class="loader-wrapper">
    <div class="loader"></div>
</div>
<div class="d-none page-wrapper" data-bind="css:{'d-none':false}">
    <nav class="navbar navbar-light align-items-center">
        <div style="color: #0056b3; font-size: 22px; font-weight: 500;vertical-align: -webkit-baseline-middle;">
            <a class="navbar-brand" href="https://www.vaccineimpact.org">
                <img src="./logo-dark-drop.png" height="70px"/>
            </a>
            VIMC Data Visualisation Tool
        </div>
        <div class="small" style="color: #0056b3; max-width: 550px">
            <div data-bind="visible: isPrivate">
                <div data-bind="text: reportId"></div>
                <div>Data ids:
                <a class="d-inline-block" data-bind="attr: { href: dataLink1, title: linkText }, text: dataId1"></a> /
                <a class="d-inline-block" data-bind="attr: { href: dataLink2, title: linkText }, text: dataId2"></a>
                </div>
                <div data-bind="text: appId"></div>
            </div>
            <span  data-bind="visible: !isPrivate()">
                This tool shows the Vaccine Impact Modelling Consortium's estimates of health impact from vaccination
                against
                10 pathogens in 98 low and middle income countries from 2000 to 2019. <br/>
                <a href="https://www.vaccineimpact.org">More information about VIMC</a><br/>
                <a href="https://doi.org/10.1016/S0140-6736(20)32657-X" target="_blank">Read the publication underlying these estimates</a>
            </span>
        </div>
    </nav>

    <div class="clearfix"></div>
    <div class="sidebar in">
        <div class="m-3">Plots</div>
        <ul class="nav flex-column border-bottom border-top" data-bind="foreach: plots">
            <li class="nav-item">
                <a class="nav-link"
                   href="#"
                   data-bind="text: $data,
                css: { active: $parent.currentPlot() == $data },
                click: () => $parent.selectPlot($data)">
                </a>
            </li>
        </ul>
    </div>

    <div class="filter-bar sidebar" data-bind="css: { in: showSidebar}">
        <div class="m-3">
            <a href="#" data-bind="visible: !showSidebar(), click: () => showSidebar(true)"
               style="text-decoration: none !important;">
                <svg height="20" style="vertical-align: text-bottom;" viewBox="0 0 8 16" version="1.1" width="16"
                     aria-hidden="true">
                    <path fill-rule="evenodd" fill="#007bff" d="M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"></path>
                </svg>
                <svg height="20" style="vertical-align: text-bottom; margin-left:-12px;" viewBox="0 0 8 16"
                     version="1.1"
                     width="16" aria-hidden="true">
                    <path fill-rule="evenodd" fill="#007bff" d="M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"></path>
                </svg>
            </a>
            <a href="#" data-bind="visible: showSidebar, click: () => showSidebar(false)"
               style="text-decoration: none !important;">
                <svg height="20" style="vertical-align: text-bottom;" class="octicon octicon-chevron-left"
                     viewBox="0 0 8 16" version="1.1" width="16" aria-hidden="true">
                    <path fill-rule="evenodd"
                          fill="#007bff" d="M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"></path>
                </svg>
                <svg height="20" style="vertical-align: text-bottom; margin-left:-12px"
                     class="octicon octicon-chevron-left"
                     viewBox="0 0 8 16" version="1.1" width="16" aria-hidden="true">
                    <path fill-rule="evenodd"
                          fill="#007bff" d="M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"></path>
                </svg>
                <span style="margin-top: -10px">collapse filter menu</span>
            </a>
        </div>

        <ul class="nav flex-column border-bottom border-top" data-bind="visible: showSidebar">
            <li class="nav-item" data-bind="with: yearFilter, visible: showYearFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}">
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            First year:
                            <select class=form-control data-bind="options: rangeValues, value: selectedLow"></select>
                        </div>
                    </div>
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            Last year:
                            <select class=form-control data-bind="options: rangeValues, value: selectedHigh"></select>
                        </div>
                    </div>
                </div>
            </li>

            <li class="nav-item" data-bind="with: activityFilter, visible: showActivityFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}, foreach: options">
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            <label data-bind="attr: {for: $data}">
                                <input type="checkbox" data-bind="attr: {id: $data, value: $data},
                checked: $parent.selectedOptions"/>
                                <span data-bind="text: $data"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </li>

            <li class="nav-item" data-bind="with: countryFilter, visible: showCountryFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}">
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('all')">All
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('none')">None
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('pine')">PINE 5
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('gavi77')">Gavi 77
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('gavi73')">Gavi 73
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('gavi72')">Gavi 72
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('gavi68')">Gavi 68
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('dove94')">Dove 94
                            </button>
                            <button type="button" class="btn btn-primary mt-1 btn-sm"
                                    data-bind="click: () => selectCountryGroup('dove96')">Dove 96
                            </button>

                        </div>
                    </div>
                    <hr>
                    <div data-bind="foreach: options">
                        <div class="nav-item nav-option">
                            <div class="nav-link">
                                <label data-bind="attr: {for: $data}">
                                    <input type="checkbox"
                                           data-bind="attr: { value: $data, id: $data }, checked: $parent.selectedOptions">
                                    <span data-bind="text: $parent.makeHumanreadable($data)"></span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </li>

            <li class="nav-item" data-bind="with: vaccineDiseaseFilter, visible: showVaccineFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}">
                    <div data-bind="if: displayAggregateAll" class="nav-item nav-option">
                        <div class="nav-link">
                            <label>
                                <input type="checkbox" data-bind="checked: aggregateAll"/>
                                <span>Aggregate all diseases</span>
                            </label>
                        </div>
                        <hr data-bind="visible: !aggregateAll">
                    </div>
                    <div data-bind="if: !aggregateAll">
                        <div data-bind="foreach: vaccineFilters">
                            <div data-bind="if: $parent.displayVaccineFilter($data.name())" class="nav-item nav-option">
                                <div class="nav-link">
                                    <label data-bind="attr: {for: name}">
                                        <span data-bind="text: makeHumanreadable(name())"></span>
                                        <select multiple="multiple" class="form-control"
                                                data-bind="options: options, selectedOptions: selectedOptions,
                        select2: { placeholder: 'Select vaccines', closeOnSelect: true }">
                                        </select>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>

            <li class="nav-item" data-bind="with: diseaseFilter, visible: showDiseaseFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}">
                    <div data-bind="if: displayAggregateAll" class="nav-item nav-option">
                        <div class="nav-link">
                            <label>
                                <input type="checkbox" data-bind="checked: aggregateAll"/>
                                <span>Aggregate all diseases</span>
                            </label>
                        </div>
                        <hr data-bind="visible: !aggregateAll">
                    </div>
                    <div data-bind="visible: !aggregateAll">
                        <div class="nav-item nav-option">
                            <div class="nav-link">
                                <button type="button" class="btn btn-primary mt-1 btn-sm"
                                        data-bind="click: () => selectAll()">All
                                </button>
                                <button type="button" class="btn btn-primary mt-1 btn-sm"
                                        data-bind="click: () => selectNone()">None
                                </button>
                            </div>
                        </div>
                        <hr>
                        <div data-bind="foreach: options">
                            <div data-bind="if: $parent.displayDiseaseFilter($data)" class="nav-item nav-option">
                                <div class="nav-link">
                                    <label data-bind="attr: {for: $data}">
                                        <input type="checkbox" data-bind="attr: {id: $data, value: $data},
                    checked: $parent.selectedOptions"/>
                                        <span data-bind="text: $data"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </li>

            <li class="nav-item" data-bind="with: touchstoneFilter, visible: showTouchstoneFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}, foreach: options">
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            <label data-bind="attr: {for: $data}">
                                <input type="checkbox"
                                       data-bind="attr: { value: $data, id: $data }, checked: $parent.selectedOptions">
                                <span data-bind="text: $data"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </li>
            <li class="nav-item" data-bind="with: supportFilter, visible: showSupportFilter">
                <a class="nav-link nav-parent"
                   href="#"
                   data-bind="text: name,
                css: { active: isOpen },
                click: toggleOpen"></a>

                <div class="filter clearfix" data-bind="css: {in: isOpen}, foreach: options">
                    <div class="nav-item nav-option">
                        <div class="nav-link">
                            <label data-bind="attr: {for: $data}">
                                <input type="checkbox"
                                       data-bind="attr: { value: $data, id: $data }, checked: $parent.selectedOptions">
                                <span data-bind="text: $parent.makeHumanreadable($data)"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </li>
        </ul>
      <div class="m-3" data-bind="visible: showSidebar">
        <a data-toggle="modal" class="text-info" href="#" data-target="#helpFilterModal">
          <i class="fa-lg fa fa-question-circle"></i> Explanation of filters</a>
      </div>
      <div class="mx-3" data-bind="visible: showSidebar">
        <button class="btn btn-success btn-block" data-bind="click: exportAllData">
          Export complete dataset <i class="fa fa-download" aria-hidden="true"></i>
        </button>
        <div class="small" data-bind="visible: !isPrivate()">
          This data is shared under the <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0 licence</a>.
        </div>
      </div>
    </div>

    <div class="contents container-fluid">
        <div class="tab-content">
            <div id="impact" class="container-fluid tab-pane" data-bind="css: {'active': currentPlot() == 'Impact'}">
                <div class="row">
                    <div class="col-12 p-5">
                        <form class="mb-0">
                            <div class="form-group row">
                                <div class="col-9">
                                    <div class="btn-group mt-1" role="group">
                                        <!-- ko if: showCross -->
                                        <button type="button" class="btn btn-primary" data-bind="click: () => changeMethod('cross'),
                   css: {active: yearMethod() == 'cross'}">Calendar year
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: showCohort -->
                                        <button type="button" class="btn btn-primary" data-bind="click: () => changeMethod('cohort'),
                   css: {active: yearMethod() == 'cohort'}">Year of birth
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: showYearOfVac -->
                                        <button type="button" class="btn btn-primary active" data-bind="click: () => changeMethod('year_of_vac'),
                   css: {active: yearMethod() == 'year_of_vac'}">Year of vaccination
                                        </button>
                                        <!-- /ko -->
                                    </div>
                                    <a class="text-info" href="#" data-toggle="modal"
                                            data-target="#methodModal">
                                        <i class="fa-lg fa fa-question-circle"></i>
                                    </a>
                                </div>
                            </div>

                            <div class="btn-group mt-1" role="group" data-bind="visible: showAgeGroupToggle()">
                                <button type="button" class="btn btn-primary" data-bind="click: () => changeAgeGroup('all'),
               css: {active: ageGroup() == 'all'}">All Ages
                                </button>
                                <button type="button" class="btn btn-primary" data-bind="click: () => changeAgeGroup('under5'),
               css: {active: ageGroup() == 'under5'}">Under 5s
                                </button>
                            </div>
                        </form>
                        <hr/>
                        <form class="mb-4">
                            <div class="form-group row">
                                <div class="col-4">
                                    <p>Compare across <span class="info icon" data-toggle="tooltip" data-placement="top"
                                                            title="What should we use as the x-axis for the graph?">
              </span></p>
                                    <select class="form-control"
                                            data-bind="options: xAxisOptions, value: xAxis"></select>
                                </div>
                                <div class="col-4" style="margin-top: 46px;">
                                    <div class="form-check" data-bind="visible: xAxis() == 'year'">
                                        <input class="form-check-input" type="checkbox"
                                               data-bind="checked: cumulativePlot"
                                               id="cumulativePlotId">
                                        <label class="form-check-label" for="cumulativePlotId">
                                            Cumulative
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-4">
                                    <p>Stratify by <span class="info icon" data-toggle="tooltip" data-placement="top"
                                                         title="What should we stratify by?">
              </span></p>
                                    <select class="form-control"
                                            data-bind="options: yAxisOptions, value: yAxis"></select>
                                </div>
                                <div class="col-4">
                                    <p>Max bars <span class="info icon" data-toggle="tooltip" data-placement="top"
                                                      title="How many values should we plot on the x-axis?">
               </span></p>
                                    <select type="number" class="form-control" style="width: 100px;"
                                            data-bind="options: maxPlotOptions, value: maxBars"></select>
                                </div>
                            </div>

                            <a class="text-info" href="#" data-toggle="modal"
                                    data-target="#helpPlotModal">
                                <i class="fa fa-lg fa-question-circle"></i>
                              Explanation of plot options
                            </a>

                        </form>
                        <form class="mb-5">
                            <div class="form-group row">
                                <div class="col">
                                    <div class="btn-group" role="group">
                                        <!-- ko if: visbleMetricButtons().includes('deaths') -->
                                        <button type="button" class="btn btn-primary active"
                                                data-bind="click: () => changeBurden('deaths'),
                             css: {active: humanReadableBurdenOutcome() == 'deaths'},
                             if: visbleMetricButtons().includes('deaths')">Deaths
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('deaths_averted') -->
                                        <button type="button" class="btn btn-primary active"
                                                data-bind="click: () => changeBurden('deaths_averted'),
                            css: {active: humanReadableBurdenOutcome() == 'deaths_averted'},
                            if: visbleMetricButtons().includes('deaths_averted')">Deaths averted
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('dalys') -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeBurden('dalys'),
                            css: {active: humanReadableBurdenOutcome() == 'dalys'},
                            visible: visbleMetricButtons().includes('dalys')">DALYs
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('dalys_averted') -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeBurden('dalys_averted'),
                             css: {active: humanReadableBurdenOutcome() == 'dalys_averted'}">DALYs averted
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('cases') -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeBurden('cases'),
                             css: {active: humanReadableBurdenOutcome() == 'cases'}">Cases
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('cases_averted') -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeBurden('cases_averted'),
                             css: {active: humanReadableBurdenOutcome() == 'cases_averted'}">Cases averted
                                        </button>
                                        <!-- /ko -->
                                        <!-- ko if: visbleMetricButtons().includes('fvps') -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeBurden('fvps'),
                             css: {active: humanReadableBurdenOutcome() == 'fvps'},
                             enable: yearMethod() == 'year_of_vac'">FVPS
                                        </button>
                                        <!-- /ko -->
                                    </div>
                                    <a class="text-info" href="#" data-toggle="modal"
                                            data-target="#helpMetricModal">
                                        <i class="fa-lg fa fa-question-circle"></i>
                                    </a>
                                </div>
                            </div>
                        </form>

                        <p style="font-weight:bold;color:red"
                           data-bind="text: warningMessage, visible: showWarning">
                        </p>

                        <div style="max-width: 1000px">
                            <canvas id="myChart"></canvas>
                        </div>

                        <form class="mt-3">
                            <div class="form-group row">
                                <div class="col-1">
                                    <label for="plot-title" class="col-form-label">Title</label>
                                </div>
                                <div class="col-12 col-sm-7">
                                    <input type="text" id="plot-title" class="form-control"
                                           data-bind="value: plotTitle"/>
                                </div>
                                <div class="col-12 col-sm-4">
                                    <button class="btn btn-success" data-bind="click: applyTitle">Apply</button>
                                    <button class="btn btn-success" data-bind="click: resetTitle">Reset</button>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" data-bind="checked: hideLabels"
                                               id="hideLabelsId">
                                        <label class="form-check-label" for="hideLabelsId">Hide Labels</label>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <button class="btn btn-success" data-bind="click: exportPlot">
                          Export plot as png <i class="fa fa-download" aria-hidden="true"></i></button>
                        <button class="btn btn-success" data-bind="click: exportData">
                          Export data as csv <i class="fa fa-download" aria-hidden="true"></i></button>
                        <button class="btn btn-success" data-toggle="modal" data-target="#metadataModal">
                            Show Metadata
                        </button>
                        <div data-bind="visible: !isPrivate()" class="small">
                          This data is shared under the <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY
                          4.0 licence</a>.
                        </div>
                    </div>
                </div>
            </div>
            <div id="timeseries" class="container-fluid tab-pane" data-bind="css: {'active': currentPlot() == 'Time series'}">
                <div class="row">
                    <div class="col-12 p-5">
                        <form class="mb-0">
                            <div class="form-group row">
                                <div class="col-9">
                                    <div class="btn-group mt-1" role="group">
                                      <!-- ko if: showCross -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeMethod('cross'),
                                                 css: {active: yearMethod() == 'cross'}">Calendar year
                                        </button>
                                      <!-- /ko -->
                                      <!-- ko if: showCohort -->
                                        <button type="button" class="btn btn-primary"
                                                data-bind="click: () => changeMethod('cohort'),
                                                 css: {active: yearMethod() == 'cohort'}">Year of birth
                                        </button>
                                      <!-- /ko -->
                                      <!-- ko if: showYearOfVac -->
                                        <button type="button" class="btn btn-primary active"
                                                data-bind="click: () => changeMethod('year_of_vac'),
                                                 css: {active: yearMethod() == 'year_of_vac'}">Year of vaccination
                                        </button>
                                      <!-- /ko -->
                                    </div>
                                    <a class="text-info" href="#" data-toggle="modal"
                                            data-target="#methodModal">
                                        <i class="fa fa-lg fa-question-circle"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="btn-group mt-1" role="group" data-bind="visible: showAgeGroupToggle()">
                                <button type="button" class="btn btn-primary" data-bind="click: () => changeAgeGroup('all'),
               css: {active: ageGroup() == 'all'}">All Ages
                                </button>
                                <button type="button" class="btn btn-primary" data-bind="click: () => changeAgeGroup('under5'),
               css: {active: ageGroup() == 'under5'}">Under 5s
                                </button>
                            </div>
                        </form>
                        <hr/>
                        <form class="mb-4">
                            <div class="form-group row">
                                <div class="col-4">
                                    <p>Stratify by <span class="info icon" data-toggle="tooltip" data-placement="top"
                                                         title="What should we stratify by?">
              </span></p>
                                    <select class="form-control"
                                            data-bind="options: yAxisOptions, value: yAxis"></select>
                                </div>
                                <div class="col-4" style="margin-top: 35px;">
                                    <div class="form-check"
                                         data-bind="visible: (!['coverage','cases_averted_rate','dalys_averted_rate','deaths_averted_rate'].includes(burdenOutcome()))">
                                        <input class="form-check-input" type="checkbox"
                                               data-bind="checked: cumulativePlot"
                                               id="cumulativePlotId">
                                        <label class="form-check-label" for="cumulativePlotId">
                                            Cumulative
                                        </label>
                                    </div>
                                    <div class="form-check" data-bind="if: showUncertainty">
                                        <input class="form-check-input" type="checkbox"
                                               data-bind="checked: uncertaintyChecked"
                                               id="uncertaintyId">
                                        <label class="form-check-label" for="uncertaintyId">
                                            Show Uncertainty
                                        </label>
                                        <span data-bind="with: diseaseFilter">
                    <span data-bind="if: displayAggregateAll">
                      <a class="text-info" href="#"
                              data-toggle="modal" data-target="#helpUncertaintyModal">
                        <i class="fa fa-lg fa-question-circle"></i>
                      </a>
                    </span>
                  </span>
                                    </div>
                                </div>
                            </div>
                            <a class="text-info" href="#" data-toggle="modal"
                                    data-target="#helpPlotModal">
                                <i class="fa fa-lg fa-question-circle"></i>
                              Explanation of plot options
                            </a>
                        </form>
                        <form class="mb-5">
                            <div class="form-group row">
                              <div class="col">
                                <div class="btn-group" role="group">
                                  <!-- ko if: visbleMetricButtons().includes('deaths') -->
                                    <button type="button" class="btn btn-primary active"
                                            data-bind="click: () => changeBurden('deaths'),
                           css: {active: humanReadableBurdenOutcome() == 'deaths'}">Deaths
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('deaths_averted') -->
                                    <button type="button" class="btn btn-primary active"
                                            data-bind="click: () => changeBurden('deaths_averted'),
                          css: {active: humanReadableBurdenOutcome() == 'deaths_averted'}">Deaths averted
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('dalys') -->
                                    <button type="button" class="btn btn-primary"
                                            data-bind="click: () => changeBurden('dalys'),
                          css: {active: humanReadableBurdenOutcome() == 'dalys'}">DALYs
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('dalys_averted') -->
                                    <button type="button" class="btn btn-primary"
                                            data-bind="click: () => changeBurden('dalys_averted'),
                           css: {active: humanReadableBurdenOutcome() == 'dalys_averted'}">DALYs averted
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('cases') -->
                                    <button type="button" class="btn btn-primary"
                                            data-bind="click: () => changeBurden('cases'),
                           css: {active: humanReadableBurdenOutcome() == 'cases'}">Cases
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('cases_averted') -->
                                    <button type="button" class="btn btn-primary"
                                            data-bind="click: () => changeBurden('cases_averted'),
                           css: {active: humanReadableBurdenOutcome() == 'cases_averted'}">Cases averted
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('fvps') -->
                                    <button type="button" class="btn btn-primary"
                                            data-bind="click: () => changeBurden('fvps'),
                           css: {active: humanReadableBurdenOutcome() == 'fvps'},
                           enable: yearMethod() == 'year_of_vac'">FVPS
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('deaths_averted_rate') -->
                                    <button type="button" class="btn btn-warning"
                                            data-bind="click: () => changeBurden('deathsRate'),
                           css: {active: humanReadableBurdenOutcome() == 'deathsRate'},
                           enable: yearMethod() == 'year_of_vac'">Deaths (rate)
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('cases_averted_rate') -->
                                    <button type="button" class="btn btn-warning"
                                            data-bind="click: () => changeBurden('casesRate'),
                           css: {active: humanReadableBurdenOutcome() == 'casesRate'},
                           enable: yearMethod() == 'year_of_vac'">Cases (rate)
                                    </button>
                                  <!-- /ko -->
                                  <!-- ko if: visbleMetricButtons().includes('coverage') -->
                                    <button type="button" class="btn btn-warning"
                                            data-bind="click: () => changeBurden('coverage'),
                           css: {active: humanReadableBurdenOutcome() == 'coverage'},
                           enable: yearMethod() == 'year_of_vac'">Coverage
                                    </button>
                                  <!-- /ko -->
                                </div>
                                <a class="text-info" href="#" data-toggle="modal"
                                        data-target="#helpMetricModal">
                                    <i class="fa fa-lg fa-question-circle"></i>
                                </a>
                              </div>
                            </div>
                        </form>

                        <p style="font-weight:bold;color:red"
                           data-bind="text: warningMessage, visible: showWarning">
                        </p>

                        <div style="max-width: 1000px">
                            <canvas id="timeSeriesChart"></canvas>
                        </div>

                        <!--           <p>
                                    When stratifying by anything other than disease, the plots might overstate the total figures. This is because we might count the same person as dying from different diseases.
                                  </p> -->
                      <div class="mt-3">
                          <button class="btn btn-success" data-bind="click: exportTSPlot">
                            Export plot as png <i class="fa fa-download" aria-hidden="true"></i>
                          </button>
                          <button class="btn btn-success" data-bind="click: exportTSData">
                            Export data as csv <i class="fa fa-download" aria-hidden="true"></i>
                          </button>
                          <button class="float-bottom btn btn-success" data-toggle="modal" data-target="#metadataModal">
                              Show Metadata
                          </button>
                          <div data-bind="visible: !isPrivate()" class="small">
                            This data is shared under the <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY
                            4.0 licence</a>.
                          </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Help Modal -->
<div class="modal fade" id="helpPlotModal" tabindex="-1" role="dialog" aria-labelledby="helpModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpModalLabel">
                    <span data-bind="text: modalHelpTitle"></span>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <span data-bind="html: modalHelpMain"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Filter Modal -->
<div class="modal fade" id="helpFilterModal" tabindex="-1" role="dialog" aria-labelledby="helFilterLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpFilterLabel">
                    Filter Options
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div><h4>Years</h4>The years for which we show the data. The meaning of the year depends on the plot
                method chosen.</div>
                <div data-bind="visible: isPrivate"><h4>Activity</h4>The type of vaccination program - routine or
                campaign.</div>
                <div><h4>Country</h4>The countries for which we show the data.</div>
                <div><h4>Disease / Vaccine</h4>The vaccines for which we show the data. Use the 'Aggregate all diseases'
                checkbox to show data aggregated across all diseases and vaccines to exclude double-counting.</div>
                <div data-bind="visible: isPrivate"><h4>Touchstone</h4>The touchstone for which we show the data. This
                should usually be set to the latest touchstone, and selecting multiple touchstone is usually
                incorrect.</div>
                <div data-bind="visible: isPrivate"><h4>Support Type</h4>Gavi vs non-Gavi vaccination programs</div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Metrics Modal -->
<div class="modal fade" id="helpMetricModal" tabindex="-1" role="dialog" aria-labelledby="helpMetricLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="helpMetricLabel">
                    Metrics
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <span data-bind="html: modalMetricsHelpMain"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Method Modal -->
<div class="modal fade" id="methodModal" tabindex="-1" role="dialog" aria-labelledby="methodModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="methodModalLabel">Explanation of methods</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <a data-bind="visible: showCross"/>
                <h2>Calendar year</h2>
                <p>This method shows the impact by calendar year, e.g. the number of people who would have died in a
                    given year but whose deaths were averted due to vaccination given at any previous time. This is also
                    known as "cross-sectional impact". While the resulting estimates are intuitively easy to understand,
                    they fail to represent the long-term future impact of vaccination on individual disease risk. In
                    addition, the impact estimates cannot be linked to specific vaccination activities.</p>
                </a>

                <a data-bind="visible: showCohort"/>
                <h2>Year of birth</h2>
                <p>This method shows the impact for each birth cohort, e.g. the number of deaths prevented in a cohort
                    born in a given year, over the course of their lifetime. We calculate impact for birth cohorts from
                    2000 to 2030, and consider the lifetime up to 2100. This is also known as "lifetime impact" or
                    "cohort impact". This approach is appropriate for capturing the direct effects of vaccination in
                    protecting the immunised individual. However, indirect effects of vaccination (acting via herd
                    immunity) play out across the whole population.</p>
                </a>

                <a data-bind="visible: showYearOfVac"/>
                <h2>Year of Vaccination</h2>
                <p>This is the approach used by VIMC to estimate vaccine impact by year of vaccination. It can be used
                    to easily determine the efficacy of a particular vaccination campaign.</p>
                </a>
                <hr>
                <p>A technical description of our impact estimation methods can be found at
                    <a href="https://www.vaccineimpact.org/resources/" target="_blank">https://www.vaccineimpact.org/resources/</a>.
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Meta-data modal -->
<div class="modal fade" id="metadataModal" tabindex="-1" role="dialog" aria-labelledby="metadataModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="methodModalLabel">Plot Metadata</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <span data-bind="html: metaData"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Uncertainty Modal -->
<div class="modal fade" id="helpUncertaintyModal" tabindex="-1" role="dialog" aria-labelledby="uncertaintyModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="uncertaintyModalLabel">Uncertainty</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>
                    Uncertainty is approximate when multiple diseases are selected and the plot is stratified by any
                    value other
                    than disease. This is because uncertainty is summed across each selected disease, which may result
                    in
                    double-counting of some metrics. To see calculated uncertainty across all disease, select
                    'Aggregate all diseases' in the Disease filter.
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script src="bundle.js"></script>

</body>
</html>
